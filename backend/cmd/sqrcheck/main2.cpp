#include <iostream>
#include <ctime>
#include <cassert>
#include "./bigint/BigIntegerLibrary.hh"
using namespace std;

int main() {
  int t = 10000;  // guess
  int b = 2;
  BigUnsigned p = stringToBigUnsigned("66203613995635620068950459585648335905192092089967823434921498695066471577332899402286163668773513934998384744366112949966982164771114427612757121196328525928630707676069888137088462085575745552319061198646810526835770222804881957424533401399482485861872741495470250988350625365322286114880045876705802328631");
  BigUnsigned q = stringToBigUnsigned("102750227528554553361067481351001413240819233250343345470341671156187505617037010409537721059907229321759571134310613932058514709407260831014149748507625248253675492654075295493475541008302371641073777410900718908246809244281099778100742892350520227068750164955829225899636100683052203775191842210275055224993");
  BigUnsigned expected = stringToBigUnsigned("6131364983101384671609370672685953010411399834322718063163043077647725048580426192814398081703471482701811688133177503587378299842030251087703604712056619626529705201109005074152142239666472519744624006336114584417166526210193237483687747671013168796206888362694635767184197315612057673438594496632269394210366735111098904922365563017716512657348061882791755253610626224666244062901911171407592141157760652525715526661063798843591535183972094941877255312440609172199411094972819338742054359692934882648086734837723324604500849711279163737606059903253952513161790216435599787967948177627926829781282229205324192279836");
  BigUnsigned n = p * q;
  BigUnsigned r;
  BigUnsigned exp = BigUnsigned(1) << t;

  clock_t begin = clock();
  r = modexp(b, exp, n);
  clock_t end = clock();

  assert(r == expected);
  double elapsed_secs = double(end - begin) / CLOCKS_PER_SEC;
  cout << "Squarings per second (C++ + BIL): " << (double) t / elapsed_secs << "\n";
}
