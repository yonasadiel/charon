package main

import (
	"fmt"
	"math/big"
	"time"
)

func main() {
	var t uint = 1000000 // guess
	var b, p, q, expected, n, r, exp *big.Int
	b = big.NewInt(2)
	p, _ = big.NewInt(1).SetString("66203613995635620068950459585648335905192092089967823434921498695066471577332899402286163668773513934998384744366112949966982164771114427612757121196328525928630707676069888137088462085575745552319061198646810526835770222804881957424533401399482485861872741495470250988350625365322286114880045876705802328631", 10)
	q, _ = big.NewInt(1).SetString("102750227528554553361067481351001413240819233250343345470341671156187505617037010409537721059907229321759571134310613932058514709407260831014149748507625248253675492654075295493475541008302371641073777410900718908246809244281099778100742892350520227068750164955829225899636100683052203775191842210275055224993", 10)
	expected, _ = big.NewInt(1).SetString("1235686480410350321709050679223516474113481857848518742337444664059543564886011878564213023899819350015982875600268261603327443124177467218954322487838692303594730639377975672669423357033282912779593534668185478080816773004343217244397858513055153705290373549032761624637233396879038508518304077125917944516081372693863645624591399121709922071610444437700417145274350328404164534620943892396382992812696252045989908089590715065059627493925666564939094931043316883166701115140236645290058689371326040451483928431261694862203562347703711786144009767263588363655906853126667682872762807870358050001653481573073152617986", 10)
	n = big.NewInt(1).Mul(p, q)
	exp = new(big.Int).Lsh(big.NewInt(1), t)

	start := time.Now()
	r = new(big.Int).Exp(b, exp, n)
	end := time.Now()

	if r.Cmp(expected) != 0 {
		panic("wrong result")
	}
	elapsed := end.Sub(start).Seconds()
	fmt.Printf("Squarings per second (Go + math/big): %.10f\n", float64(t)/elapsed)
}
